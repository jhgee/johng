box: debian
build:
  steps:
    - script:
        name: install git
        code: |
          apt-get update && apt-get install git -y
    - script:
        name: initialize git submodules
        code: |
            git submodule update --init --recursive
    - arjen/hugo-build:
        version: "0.15"
deploy:
   steps:
    # - script:
    #     name: Copying public folder for deployment
    #     code: |
    #       mkdir -p /tmp/pipeline
    #       mv $WERCKER_ROOT/* /tmp/pipeline/
    #       mv /tmp/pipeline/public/* $WERCKER_ROOT
    - script:
        name: install lftp
        code: |
          apt-get update && apt-get install lftp
    - script:
        name: ftp deploy
        code: |
          lftp sftp://$USER:$PASS@johng.de/  -e "mirror  --reverse -e -R $WERCKER_ROOT/public / --verbose; bye"
    # - duleorlovic/ftp-deploy:
    #     basedir: public/
    #     destination: ftp://johng.de/
    #     username: $FTP-USER
    #     password: $PASS
