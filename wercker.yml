box: debian
build:
  steps:
    - install-packages:
        packages: git
    - script:
        name: initialize git submodules
        code: |
            git submodule update --init --recursive
    - arjen/hugo-build:
        version: "0.15"
    - script:
        name: copy output directory
        code: |
          cp * -R $WERCKER_OUTPUT_DIR
deploy:
   steps:
    - install-packages:
        packages: git lftp
    # - duleorlovic/ftp-deploy:
    #     basedir: public/
    #     destination: ftp://johng.de/
    #     username: $USER
    #     password: $PASS
    - script:
        name: prepare lftp settings
        code: |
          mkdir -p $HOME/.lftp
          echo "set ssl:verify-certificate no" > $HOME/.lftp/rc
    - script:
        name: ftp deploy
        code: |
          echo $WERCKER_ROOT
          echo ./
          lftp sftp://$USER:$PASS@johng.de/  -e "mirror  --reverse -e -R ./public / --verbose; bye"
